# Changelog

このプロジェクトの全ての重要な変更を記録します。

フォーマットは [Keep a Changelog](https://keepachangelog.com/ja/1.0.0/) に基づいており、
バージョニングは [Semantic Versioning](https://semver.org/lang/ja/) に準拠しています。

## [Unreleased]

### 変更
- 印刷機能を利用できるようメインウィンドウの capability に `core:webview:allow-print` を追加
- README と開発ドキュメントに Tauri Capabilities 設定と印刷手順を追記
- `window.print()` の利用箇所へ Capabilities 依存関係をコメントで明記
- プロジェクト README を再構成し、全ディレクトリの役割を整理した `docs/DIRECTORY_COMMENTS.md` を追加

### 予定されている機能
- TypeScriptのモジュール分割（types, utils, features, services）
- 単体テストの追加
- 開発ドキュメントの整備
- コードコメントの追加

## [0.1.0] - 2025-10-21

### 追加機能

#### BOM比較・マージ機能
- 2つのBOMファイルの差分比較機能
- 追加・削除・変更・一致の4種類の差分を色分けして表示
- マージBOMの自動生成
- 差分結果のCSVエクスポート

#### ファイル形式サポート
- **入力対応**: CSV, XLSX, CADネットリスト（PADS-ECO, MSF SHAPE, CCF DEFINITION）
- **出力対応**: CSV, PADS-ECO (.eco), CCF (.ccf), MSF (.msf)
- CADネットリスト形式の完全なパース・生成ロジック

#### 列の自動検出機能
- Ref（部品番号）列の自動検出
  - `Ref`, `Ref1`, `Ref2`, `RefDesignator`, `部品番号` などに対応
- Part_No（部品型番）列の自動検出
  - `Part_No`, `PartNo`, `MPN`, `型番` などに対応
  - "manufacturer"との誤検出を防止する除外ロジック
- Value, Comment, Manufacturer列の自動検出
- 3段階マッチング（完全一致 → 部分一致 → 日本語パターン）

#### 辞書機能（部品名管理）
- **登録名リスト**:
  - 部品型番（Part_No）と登録名（社内表記名）の紐付け管理
  - BOMから型番を自動抽出する機能
  - テーブル形式での直接編集（自動保存）
  - CSV インポート/エクスポート
  - BOMへの登録名一括適用
- **特定部品（例外ルール）**:
  - Ref + Part_No の組み合わせで個別の登録名を設定
  - 登録名リストより優先度が高い
  - CSV インポート/エクスポート
- localStorageでの永続化

#### ビジュアル前処理エディタ
- ブロックプログラミング風のパイプライン構築UI
- 利用可能なブロック:
  - 📋 Referenceの展開（`C1,C2,C3` → 個別行に展開）
  - ✂️ Referenceを行分割（1行複数Ref → 複数行に分割）
  - 🔄 空欄セルの補完
  - 🧹 テキストクリーニング（空白・特殊文字の除去）
  - ✨ 書式ルール適用
- ドラッグ&ドロップでブロックの順序変更
- トグルスイッチで個別ブロックの有効/無効切り替え
- ブロックの追加・削除・移動機能
- パイプライン設定のlocalStorage保存

#### タブ/プロジェクト管理
- **タブ管理**:
  - ヘッダーに現在のタブ名を表示
  - 鉛筆アイコンでタブ名のインライン編集
  - プロンプトベースの簡単なリネーム機能
- **お気に入り機能**:
  - 星アイコン（⭐）でお気に入りに追加/削除
  - お気に入りタブは金色の星で表示
  - タブリストの最上部に優先表示
  - localStorageで永続化
- **別ウィンドウで開く**:
  - Tauri WebviewWindow APIを使用
  - 複数プロジェクトの同時作業が可能
  - ウィンドウサイズ: 1400×900
- 複数プロジェクトのタブ管理
- 自動保存機能（設定可能な間隔）

#### データ編集機能
- BOMデータの直接編集機能
- 検索・置換機能
- セル単位での編集
- 編集内容のプレビュー

#### UI/UX改善
- レスポンシブデザイン
- ドラッグ&ドロップによるファイル読み込み
- ファイルピッカーによる読み込み
- 処理中オーバーレイ表示
- アクティビティログ（最新20件）
- ツールチップによる操作ガイド

### 技術的実装

#### フロントエンド
- TypeScript + Vanilla HTML/CSS
- Vite ビルドシステム
- 3,543行のメインロジック（src/main.ts）
- 1,710行のスタイルシート（src/styles.css）
- 718行のHTML構造（index.html）

#### バックエンド（Rust + Tauri 2.0）
- **パーサー**:
  - CSV パーサー（csv crate使用）
  - Excel パーサー（calamine crate使用）
  - CADネットリスト パーサー（PADS-ECO, MSF, CCF形式）
- **エクスポーター**:
  - CSV エクスポーター
  - CADネットリスト エクスポーター（PADS-ECO, CCF, MSF形式）
- **データ処理**:
  - Reference展開・分割ロジック
  - テキストクリーニング
  - 書式整形
  - バリデーション
- **ヘッダー自動検出**:
  - 多言語対応（英語・日本語）
  - 複数の列名パターンに対応
  - 誤検出防止ロジック
- **差分比較**:
  - BOM比較アルゴリズム
  - マージロジック
- **ストレージ**:
  - セッション管理
  - 辞書データ管理

### 変更点
- 初期テンプレートから大幅に拡張
- UIを垂直レイアウトに変更（横並び → 縦並び）
- モーダルベースの編集UIに変更

### 修正
- CADネットリストパーサーの完全書き直し（実際のフォーマットに対応）
- 列自動検出の精度向上（誤検出の削減）
- エラーハンドリングの改善

### セキュリティ
- ファイル読み込み時のバリデーション
- エラーメッセージの安全な表示

## [0.0.1] - 2025-10-16

### 追加
- プロジェクトの初期セットアップ
- Tauri 2.0 + TypeScript + Vite のテンプレート
- 基本的なプロジェクト構造

---

## 凡例

- `追加`: 新機能の追加
- `変更`: 既存機能の変更
- `非推奨`: まもなく削除される機能
- `削除`: 削除された機能
- `修正`: バグ修正
- `セキュリティ`: セキュリティに関する変更
