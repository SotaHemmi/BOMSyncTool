# BOMSyncTool ユーザーマニュアル

## このソフトウェアについて

BOMSyncToolは、電子部品表（BOM）の比較やデータ整理を簡単に行うためのアプリケーションです。設計担当者や部品管理担当者が、異なるバージョンのBOMを比較したり、社内の表記ルールに合わせてデータを整形したりすることができます。

## 対応しているファイル形式

- **CSV**: カンマ区切りのテキストファイル
- **XLSX**: Excelのファイル
- **PADS ECO**: PADS Logicというソフトで使われる形式
- **CCF**: CADソフト用のネットリストファイル
- **MSF**: CADソフト用のネットリストファイル
- **PWS**: PADS Wire Systemのネットリストファイル
- **BD**: Board Designerのネットリストファイル
- **PADS Report**: PADSのテキストレポート形式

## インストール方法

### Windows

1. GitHubのリポジトリから最新のインストーラー（.exeファイル）をダウンロードします
2. ダウンロードしたファイルをダブルクリックして実行します
3. 画面の指示に従ってインストールを完了します
4. デスクトップやスタートメニューから「BOMSyncTool」を起動します

### macOS

1. GitHubのリポジトリから最新のインストーラー（.dmgファイル）をダウンロードします
2. ダウンロードしたファイルをダブルクリックして開きます
3. アプリケーションをアプリケーションフォルダにドラッグします
4. アプリケーションフォルダから「BOMSyncTool」を起動します

## 基本的な使い方

### 1. アプリケーションの起動

アプリケーションを起動すると、メイン画面が表示されます。画面は大きく3つのエリアに分かれています：

- **上部**: プロジェクトタブ（複数の作業を切り替えられます）
- **中央**: BOMファイルを読み込むエリア（左側が「Dataset A」、右側が「Dataset B」）
- **下部**: 比較結果や操作履歴を表示するエリア

### 2. BOMファイルの読み込み

BOMファイルを読み込むには、以下の2つの方法があります：

**方法1: ファイルをドラッグ&ドロップ**
1. 読み込みたいファイルをWindowsエクスプローラー（またはmacOSのFinder）で見つけます
2. ファイルを「Dataset A」または「Dataset B」のエリアにドラッグして、マウスボタンを離します
3. ファイルが自動的に読み込まれます

**方法2: ファイル選択ボタンを使う**
1. 「Dataset A」または「Dataset B」エリアの「ファイルを選択」ボタンをクリックします
2. ファイル選択画面が開くので、読み込みたいファイルを選んで「開く」をクリックします

### 3. 列の役割を確認する

ファイルを読み込むと、自動的に列の役割（何のデータが入っているか）を推測します：

- **Ref**: 部品番号（例: R1, C5, U3など）
- **Part_No**: 部品の型番（例: ABC-123, XYZ-456など）
- **Manufacturer**: メーカー名（例: TDK, Murata, Texasなど）

推測が間違っている場合は、列の上部にあるドロップダウンメニューから正しい役割を選び直してください。

### 4. BOMを比較する

2つのBOMファイルを読み込んだら、比較を実行できます：

1. 画面中央の「比較」ボタンをクリックします
2. 少し待つと、比較結果が下部のエリアに表示されます
3. 結果は色分けされています：
   - **緑色**: 追加された部品
   - **赤色**: 削除された部品
   - **黄色**: 変更された部品
   - **白色**: 変更なしの部品

### 5. 結果をフィルタリングする

比較結果が多い場合、必要な情報だけを表示できます：

1. 結果テーブルの上部にある「フィルタ」を使います
2. 例えば「差分のみ」を選ぶと、変更がない部品は非表示になります
3. 「追加のみ」を選ぶと、追加された部品だけが表示されます

### 6. 結果をファイルに保存する（エクスポート）

比較結果をファイルに保存するには：

1. 結果エリアの右上にある「エクスポート」ボタンをクリックします
2. 保存したい形式を選びます（CSV、XLSX、ECOなど）
3. 保存先のフォルダとファイル名を指定します
4. 「保存」をクリックすると、ファイルが作成されます

### 7. 結果を印刷する

比較結果を紙に印刷したい場合：

1. 結果エリアの右上にある「印刷」ボタンをクリックします
2. 印刷プレビュー画面が表示されます
3. プリンター設定を確認して「印刷」をクリックします
4. PDFとして保存することもできます

## データを整理する（前処理機能）

BOMデータを読み込んだ後、データを整理することができます：

1. 「Dataset A」または「Dataset B」エリアの「編集」ボタンをクリックします
2. 編集画面が開きます
3. 「前処理」ボタンをクリックすると、以下の整理機能が使えます：
   - **Reference展開**: 「R1-R4」のような範囲表記を「R1」「R2」「R3」「R4」の個別行に分割
   - **空欄補完**: 空白になっているセルを上の行の値で埋める
   - **テキストクリーニング**: 全角・半角を統一したり、余分なスペースを削除

4. 整理が終わったら「保存」ボタンをクリックします

## 辞書機能（部品名の一括置換）

社内の表記ルールに合わせて、部品名を一括で置き換えることができます：

### 辞書の設定方法

1. 画面上部の「辞書」タブをクリックします
2. 「登録名リスト」タブで、置き換えルールを登録します：
   - **部品型番（Part_No）**: 元の型番
   - **登録名**: 置き換え後の名前
3. 直接入力するか、「CSV インポート」でExcelなどで作成した一覧を読み込みます
4. 設定が終わったら「辞書を書き出し」で保存しておくと、次回も使えます

### 辞書をBOMに適用する

1. 辞書を設定した後、「BOM に適用」ボタンをクリックします
2. Dataset A または Dataset B のどちらに適用するか選択します
3. 適用が完了すると、BOMの表示が更新されます

## プロジェクト管理

複数の案件を同時に扱う場合、タブ機能を使います：

### 新しいプロジェクトを作る

1. 画面上部の「+」ボタンをクリックします
2. 新しいタブが作成されます
3. タブ名をクリックして、わかりやすい名前に変更できます

### プロジェクトを切り替える

1. 画面上部のタブをクリックすると、そのプロジェクトに切り替わります
2. それぞれのプロジェクトは独立しているので、作業が混ざることはありません

### よく使うプロジェクトをお気に入りにする

1. タブの横にある星マーク（☆）をクリックします
2. 金色の星（★）になり、左側のパネルに表示されます
3. 次回起動時も、お気に入りはすぐにアクセスできます

## トラブルシューティング

### ファイルが読み込めない

**原因**: ファイル形式が対応していない、またはファイルが壊れている可能性があります

**対処方法**:
1. ファイルの拡張子を確認してください（.csv、.xlsxなど）
2. Excelで開いて、正しくデータが表示されるか確認してください
3. CSVファイルの場合、Excelで開いて「名前を付けて保存」でもう一度CSVとして保存し直してください
4. 文字コードが「UTF-8」になっているか確認してください（メモ帳などで開いて「名前を付けて保存」→文字コードで確認）

### 列の役割が正しく認識されない

**原因**: 列の名前が一般的でない、またはデータが特殊な形式になっている

**対処方法**:
1. ファイルを読み込んだ後、列の上部にあるドロップダウンメニューで手動で役割を設定してください
2. Reference列、Part_No列、Manufacturer列を正しく設定することが重要です
3. 設定後、一度プロジェクトを保存してください

### 比較結果がおかしい

**原因**: 列の役割が正しく設定されていない、またはデータの形式が揃っていない

**対処方法**:
1. 両方のBOMファイルで、同じ列の役割が設定されているか確認してください
2. 前処理機能を使って、データの形式を揃えてください（全角・半角、空白など）
3. それでも解決しない場合は、GitHubのリポジトリに問題を報告してください

### 辞書を適用しても変更されない

**原因**: 辞書の設定が間違っている、または部品型番が完全に一致していない

**対処方法**:
1. 辞書の「部品型番」がBOMのデータと完全に一致しているか確認してください（大文字・小文字、スペースなど）
2. 前処理機能でテキストクリーニングを実行してから、辞書を適用してみてください
3. 元のBOMを再度読み込んで、最初からやり直してください

### アプリが起動しない、または動作が遅い

**原因**: パソコンのスペックが不足している、または他のアプリが干渉している

**対処方法**:
1. 他のアプリを閉じて、メモリを確保してください
2. パソコンを再起動してから、もう一度試してください
3. ウイルス対策ソフトがBOMSyncToolをブロックしていないか確認してください

## バグや問題を報告する

もしBOMSyncToolを使っていて、うまく動かない、エラーが出る、などの問題が発生した場合は、ぜひ開発チームに報告してください。報告いただくことで、ソフトウェアの改善につながります。

### 報告方法

1. GitHubのリポジトリにアクセスします:
   **https://github.com/YourOrganization/BOMSyncTool**
   （※実際のURLに置き換えてください）

2. 「Issues」タブをクリックします

3. 「New Issue」ボタンをクリックします

4. 以下の情報を記入してください：
   - **タイトル**: 問題を簡潔に説明（例：「CSVファイルが読み込めない」）
   - **問題の詳細**:
     - 何をしようとしたか
     - どのような問題が発生したか
     - エラーメッセージが表示された場合は、その内容
   - **環境情報**:
     - お使いのOS（Windows 10、Windows 11、macOSなど）
     - BOMSyncToolのバージョン（アプリの右上に表示されています）
   - **再現手順**: 問題を再現するための具体的な手順

5. 「Submit new issue」をクリックして送信します

### 報告例

```
タイトル: XLSX形式のファイルが読み込めない

詳細:
Excelで作成したBOMファイル（.xlsx形式）を読み込もうとすると、
「ファイルの読み込みに失敗しました」というエラーが表示されます。

環境:
- OS: Windows 11
- BOMSyncTool バージョン: 1.2.0

再現手順:
1. 「Dataset A」エリアに.xlsxファイルをドラッグ&ドロップ
2. エラーメッセージが表示される
3. CSV形式で保存し直すと正常に読み込める
```

## よくある質問（FAQ）

### Q1. このソフトウェアは無料ですか？

A. はい、無料でご利用いただけます。

### Q2. インターネット接続は必要ですか？

A. いいえ、一度インストールすれば、インターネットに接続していなくても使用できます。

### Q3. データはどこに保存されますか？

A. プロジェクトデータは、お使いのパソコンのローカルディスクに保存されます。ネットワーク上やクラウドには送信されません。

### Q4. 保存したデータのバックアップはどうすればいいですか？

A. 定期的に以下のフォルダをバックアップしてください：
- Windows: `C:\Users\[ユーザー名]\AppData\Roaming\com.bomsync.app`
- macOS: `~/Library/Application Support/com.bomsync.app`

### Q5. 複数のパソコンで同じプロジェクトを使えますか？

A. プロジェクトデータをファイルとして保存し、USBメモリなどで移動することで、別のパソコンでも使用できます。

### Q6. Excel形式でしかデータがありません。どうすればいいですか？

A. Excelファイル（.xlsx）もそのまま読み込めます。もし読み込めない場合は、Excelで「名前を付けて保存」→「CSV形式」で保存し直してください。

### Q7. 大量のデータを扱えますか？

A. 数千行程度のBOMであれば問題なく処理できます。数万行を超える場合は、処理に時間がかかることがあります。

## サポート情報

### 開発者への連絡

技術的な質問や機能リクエストがある場合は、GitHubのIssuesページで報告してください。

### ドキュメント

より詳しい技術的な情報は、以下のドキュメントを参照してください：
- `docs/ARCHITECTURE.md`: システムの技術的な構成
- `docs/DEVELOPMENT.md`: 開発者向けの情報
- `CHANGELOG.md`: バージョン履歴と変更内容

---

**BOMSyncToolをご利用いただき、ありがとうございます！**
