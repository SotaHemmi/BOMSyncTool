# ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

BOMSyncToolã®è¨­è¨ˆæ€æƒ³ã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚

## ğŸ“ å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  UI Layer   â”‚  â”‚  State Mgmt â”‚  â”‚   Storage   â”‚   â”‚
â”‚  â”‚ (HTML/CSS)  â”‚â†â†’â”‚(TypeScript) â”‚â†â†’â”‚(localStorage)â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â†“                â†“                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚    â”‚      Tauri IPC Bridge          â”‚                  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ IPC (JSON-RPC)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ (Rust)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  Parsers   â”‚  â”‚ Processors â”‚  â”‚ Exporters  â”‚       â”‚
â”‚  â”‚  (å…¥åŠ›)     â”‚â†’ â”‚ (å‡¦ç†)      â”‚â†’ â”‚  (å‡ºåŠ›)     â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚         â†“                â†“                â†“              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚    â”‚          Models (å…±é€šãƒ‡ãƒ¼ã‚¿æ§‹é€ )      â”‚             â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—ï¸ ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹æˆ

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆTypeScriptï¼‰

#### 1. UI Layerï¼ˆãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼‰
**è²¬å‹™**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®è¡¨ç¤ºã¨åŸºæœ¬çš„ãªã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†

**ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ:**
- `index.html`: DOMæ§‹é€ ã®å®šç¾©
- `src/styles.css`: ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆ
- ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ç™»éŒ²é–¢æ•°ç¾¤

**ãƒ•ã‚¡ã‚¤ãƒ«:**
- `index.html` (718è¡Œ)
- `src/styles.css` (1,710è¡Œ)

#### 2. Application Layerï¼ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼‰
**è²¬å‹™**: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã€çŠ¶æ…‹ç®¡ç†ã€Tauri IPCå‘¼ã³å‡ºã—

**ä¸»è¦æ©Ÿèƒ½ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«:**

**a. ãƒ‡ãƒ¼ã‚¿ç®¡ç†**
- `datasetState`: BOM A/Bã®çŠ¶æ…‹ç®¡ç†
- `currentDiffs`: å·®åˆ†çµæœã®ä¿æŒ
- `mergedBom`: ãƒãƒ¼ã‚¸çµæœã®ä¿æŒ
- `editModalState`: ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ã®çŠ¶æ…‹

**b. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†**
- `activeProjectId`: ç¾åœ¨ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆID
- `getStoredProjects()`: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§å–å¾—
- `saveStoredProjects()`: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¿å­˜
- `renderProjectTabs()`: ã‚¿ãƒ–UIæç”»

**c. è¾æ›¸ç®¡ç†**
- `dictionaryState`: ç™»éŒ²åãƒªã‚¹ãƒˆãƒ»ç‰¹å®šéƒ¨å“ã®çŠ¶æ…‹
- `renderRegistrationTable()`: ç™»éŒ²åãƒ†ãƒ¼ãƒ–ãƒ«æç”»
- `applyRegistrationToBOM()`: BOMã¸ã®é©ç”¨

**d. å‰å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³**
- `preprocessBlocks`: ãƒ–ãƒ­ãƒƒã‚¯ã®é…åˆ—
- `renderPreprocessPipeline()`: ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³UIæç”»
- `applyPreprocessing()`: ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œï¼ˆ`core/preprocessing.ts` ã¸é›†ç´„ï¼‰

**ãƒ•ã‚¡ã‚¤ãƒ«:**
- `src/main.ts` (3,543è¡Œ) - **è¦ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆ†å‰²**

#### 3. Storage Layerï¼ˆæ°¸ç¶šåŒ–å±¤ï¼‰
**è²¬å‹™**: ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–

**ä½¿ç”¨æŠ€è¡“:**
- `localStorage`: ãƒ–ãƒ©ã‚¦ã‚¶ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
  - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿
  - è¾æ›¸ãƒ‡ãƒ¼ã‚¿
  - å‰å‡¦ç†ãƒ–ãƒ­ãƒƒã‚¯è¨­å®š
  - ãŠæ°—ã«å…¥ã‚Šæƒ…å ±

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆRustï¼‰

#### 1. API Layerï¼ˆIPC ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰
**è²¬å‹™**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå—ä»˜

**ä¸»è¦ã‚³ãƒãƒ³ãƒ‰:**
- `parse_bom_file`: BOMãƒ•ã‚¡ã‚¤ãƒ«è§£æ
- `compare_boms`: BOMæ¯”è¼ƒ
- `merge_boms`: BOMãƒãƒ¼ã‚¸
- `expand_reference`: Referenceå±•é–‹
- `split_reference_rows`: Referenceåˆ†å‰²
- `fill_blank_cells`: ç©ºæ¬„è£œå®Œ
- `cleanse_text_data`: ãƒ†ã‚­ã‚¹ãƒˆã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°
- `save_session_to_file`: ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜
- `load_session_from_file`: ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿

**ãƒ•ã‚¡ã‚¤ãƒ«:**
- `src-tauri/src/lib.rs`

#### 2. Parser Layerï¼ˆè§£æå±¤ï¼‰
**è²¬å‹™**: å„ç¨®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®BOMãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£æã—ã€å…±é€šãƒ‡ãƒ¼ã‚¿æ§‹é€ ã«å¤‰æ›

**ãƒ‘ãƒ¼ã‚µãƒ¼:**
- **CSV Parser** (`parsers/csv.rs`):
  - ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šãƒ•ã‚¡ã‚¤ãƒ«ã®è§£æ
  - ãƒ˜ãƒƒãƒ€ãƒ¼è‡ªå‹•æ¤œå‡º
- **Excel Parser** (`parsers/excel.rs`):
  - .xlsx ãƒ•ã‚¡ã‚¤ãƒ«ã®è§£æ
  - calamine crateã‚’ä½¿ç”¨
- **CAD Parser** (`parsers/cad.rs`):
  - PADS-ECOå½¢å¼ï¼ˆ`*PADS-ECO*` `*PART*`ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼‰
  - MSF SHAPEå½¢å¼ï¼ˆ`$MSF { SHAPE { ... } }`ï¼‰
  - CCF DEFINITIONå½¢å¼ï¼ˆ`$CCF { DEFINITION { ... } }`ï¼‰
  - é€†æ§‹é€ ï¼ˆPart_No â†’ Refs[]ï¼‰ã®ãƒ‘ãƒ¼ã‚¹

**ãƒ•ã‚¡ã‚¤ãƒ«:**
- `src-tauri/src/parsers/mod.rs`
- `src-tauri/src/parsers/csv.rs`
- `src-tauri/src/parsers/excel.rs`
- `src-tauri/src/parsers/cad.rs`
- `src-tauri/src/parsers/builder.rs`

#### 3. Processor Layerï¼ˆå‡¦ç†å±¤ï¼‰
**è²¬å‹™**: BOMãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›ãƒ»ã‚¯ãƒ¬ãƒ³ã‚¸ãƒ³ã‚°ãƒ»æ¤œè¨¼

**ãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼:**
- **Reference Processor** (`processors/reference.rs`):
  - Referenceå±•é–‹: `C1,C2,C3` â†’ 3è¡Œã«åˆ†å‰²
  - Referenceåˆ†å‰²: 1è¡Œè¤‡æ•°Ref â†’ è¤‡æ•°è¡Œ
- **Cleaner** (`processors/cleaner.rs`):
  - ãƒ†ã‚­ã‚¹ãƒˆã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°
  - ä¸è¦ãªç©ºç™½å‰Šé™¤
  - ç‰¹æ®Šæ–‡å­—ã®æ­£è¦åŒ–
- **Formatter** (`processors/formatter.rs`):
  - æ›¸å¼ã®çµ±ä¸€
  - ãƒ‡ãƒ¼ã‚¿æ•´å½¢
- **Validator** (`processors/validator.rs`):
  - ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼
  - ã‚¨ãƒ©ãƒ¼æ¤œå‡º

**ãƒ•ã‚¡ã‚¤ãƒ«:**
- `src-tauri/src/processors/mod.rs`
- `src-tauri/src/processors/reference.rs`
- `src-tauri/src/processors/cleaner.rs`
- `src-tauri/src/processors/formatter.rs`
- `src-tauri/src/processors/validator.rs`

#### 4. Diff Layerï¼ˆå·®åˆ†æ¯”è¼ƒå±¤ï¼‰
**è²¬å‹™**: 2ã¤ã®BOMã®å·®åˆ†ã‚’æ¤œå‡ºã—ã€ãƒãƒ¼ã‚¸

**ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ:**
- **Comparator** (`diff/compare.rs`):
  - Ref ãƒ™ãƒ¼ã‚¹ã§ã®è¡Œãƒãƒƒãƒãƒ³ã‚°
  - å·®åˆ†ã®åˆ†é¡ï¼ˆè¿½åŠ /å‰Šé™¤/å¤‰æ›´/ä¸€è‡´ï¼‰
- **Merger** (`diff/merge.rs`):
  - ãƒãƒ¼ã‚¸æˆ¦ç•¥ã®å®Ÿè£…
  - å„ªå…ˆé †ä½ã«åŸºã¥ãçµ±åˆ

**ãƒ•ã‚¡ã‚¤ãƒ«:**
- `src-tauri/src/diff/mod.rs`
- `src-tauri/src/diff/compare.rs`
- `src-tauri/src/diff/merge.rs`

#### 5. Exporter Layerï¼ˆå‡ºåŠ›å±¤ï¼‰
**è²¬å‹™**: å…±é€šãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å„ç¨®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«å¤‰æ›ã—ã¦å‡ºåŠ›

**ã‚¨ã‚¯ã‚¹ãƒãƒ¼ã‚¿ãƒ¼:**
- **CSV Exporter** (`exporters/csv.rs`):
  - CSVå½¢å¼ã§ã®å‡ºåŠ›
- **CAD Exporter** (`exporters/cad.rs`):
  - PADS-ECOå½¢å¼ï¼ˆ`*PART*`ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼‰
  - CCF DEFINITIONå½¢å¼ï¼ˆ`DEFINITION { ... }`ï¼‰
  - MSF SHAPEå½¢å¼ï¼ˆ`SHAPE { ... }`ï¼‰
  - é€†æ§‹é€ ï¼ˆRef[] â†’ Part_Noï¼‰ã®ç”Ÿæˆ

**ãƒ•ã‚¡ã‚¤ãƒ«:**
- `src-tauri/src/exporters/mod.rs`
- `src-tauri/src/exporters/csv.rs`
- `src-tauri/src/exporters/cad.rs`

#### 6. Utils Layerï¼ˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£å±¤ï¼‰
**è²¬å‹™**: å…±é€šå‡¦ç†ãƒ»ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°

**ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£:**
- **Header Detector** (`utils/header.rs`):
  - åˆ—åã®è‡ªå‹•æ¤œå‡º
  - 3æ®µéšãƒãƒƒãƒãƒ³ã‚°ï¼ˆå®Œå…¨ä¸€è‡´â†’éƒ¨åˆ†ä¸€è‡´â†’æ—¥æœ¬èªï¼‰
  - æ¨™æº–ãƒ­ãƒ¼ãƒ«ï¼ˆRef / Part_No / Manufacturer / Ignoreï¼‰ã®æ¤œå‡º
  - Value ã‚„ Comment ã¯è¿½åŠ åˆ—ã¨ã—ã¦æ‰±ã„ã€è‡ªå‹•ãƒ­ãƒ¼ãƒ«ã«ã¯å«ã‚ãªã„
- **Text Utils** (`utils/text.rs`):
  - ãƒ†ã‚­ã‚¹ãƒˆæ­£è¦åŒ–
  - æ–‡å­—åˆ—å‡¦ç†

**ãƒ•ã‚¡ã‚¤ãƒ«:**
- `src-tauri/src/utils/mod.rs`
- `src-tauri/src/utils/header.rs`
- `src-tauri/src/utils/text.rs`

#### 7. Model Layerï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«å±¤ï¼‰
**è²¬å‹™**: å…±é€šãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®å®šç¾©

**ä¸»è¦ãƒ¢ãƒ‡ãƒ«:**
```rust
// ParseResult ãŒãƒ•ãƒ­ãƒ³ãƒˆ/ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å…±é€šã®ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
pub struct ParseResult {
    pub rows: Vec<Vec<String>>,                 // å…ƒãƒ‡ãƒ¼ã‚¿
    pub column_roles: HashMap<String, Vec<String>>, // å½¹å‰² â†’ åˆ—ID
    pub column_order: Vec<String>,             // è¡¨ç¤ºé †åº
    #[deprecated] pub guessed_columns: HashMap<String, usize>,
    #[deprecated] pub guessed_roles: HashMap<String, String>,
    pub errors: Vec<String>,                   // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    pub headers: Vec<String>,                  // å…ƒãƒ˜ãƒƒãƒ€ãƒ¼
    pub columns: Vec<ColumnMeta>,              // åˆ—ãƒ¡ã‚¿æƒ…å ±
    pub row_numbers: Vec<usize>,               // è¡Œç•ªå·
    pub structured_errors: Option<Vec<ParseError>>,
}
```

> ColumnRole ã®æ¨™æº–å€¤ã¯ `ref` / `part_no` / `manufacturer` / `ignore`ã€‚ãã®ä»–ã®åˆ—ã¯ ColumnMeta ã¨ `rows` ã®ç”Ÿãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦æ‰±ã„ã€å¿…è¦ã«å¿œã˜ã¦ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ä»»æ„å±æ€§ã¨ã—ã¦è§£é‡ˆã™ã‚‹ã€‚

**ãƒ•ã‚¡ã‚¤ãƒ«:**
- `src-tauri/src/models.rs`

## ğŸ”„ ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### 1. BOMãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ãƒ•ãƒ­ãƒ¼

```
User Action (ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ/D&D)
    â†“
onDropzoneFileSelected() [TypeScript]
    â†“
loadBomFile() [TypeScript]
    â†“
invoke('parse_bom_file', { path }) [Tauri IPC]
    â†“
parse_bom_file() [Rust]
    â†“
â”Œâ”€ Format Detection (æ‹¡å¼µå­åˆ¤å®š)
â”‚
â”œâ”€ CSV â†’ CsvParser::parse()
â”œâ”€ XLSX â†’ ExcelParser::parse()
â””â”€ CAD â†’ CadParser::parse()
        â†“
    ParseResult { bom_data, headers, errors, ... }
        â†“
    [Tauri IPC Response]
        â†“
datasetState.parseResult = result [TypeScript]
    â†“
updatePreviewCard() / renderPreviewTable()
    â†“
UIæ›´æ–°
```

### 2. BOMæ¯”è¼ƒãƒ•ãƒ­ãƒ¼

```
User Action (ã€Œæ¯”è¼ƒã‚’å®Ÿè¡Œã€ã‚¯ãƒªãƒƒã‚¯)
    â†“
runCompare() [TypeScript]
    â†“
invoke('compare_boms', { bomA, bomB, ... }) [Tauri IPC]
    â†“
compare_boms() [Rust]
    â†“
Comparator::compare(bomA, bomB)
    â†“
â”Œâ”€ Ref ãƒ™ãƒ¼ã‚¹ã§ãƒãƒƒãƒãƒ³ã‚°
â”œâ”€ å·®åˆ†ã®åˆ†é¡ï¼ˆadded/removed/modified/unchangedï¼‰
â””â”€ DiffRow ã®é…åˆ—ã‚’ç”Ÿæˆ
        â†“
    Vec<DiffRow>
        â†“
    [Tauri IPC Response]
        â†“
currentDiffs = diffs [TypeScript]
    â†“
renderDiffTable() / updateResultsSummary()
    â†“
UIæ›´æ–°ï¼ˆè‰²åˆ†ã‘è¡¨ç¤ºï¼‰
```

### 3. å‰å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œãƒ•ãƒ­ãƒ¼

```
User Action (ã€Œå‰å‡¦ç†ã‚’é©ç”¨ã€ã‚¯ãƒªãƒƒã‚¯)
    â†“
applyPreprocessing() [TypeScript]
    â†“
for each enabled block:
    â†“
    invoke(block.type, { rows/bom }) [Tauri IPC]
    â†“
    â”Œâ”€ expand_reference â†’ expand_reference()
    â”œâ”€ split_reference_rows â†’ split_reference_rows()
    â”œâ”€ fill_blank_cells â†’ fill_blank_cells()
    â”œâ”€ cleanse_text_data â†’ cleanse_text_data()
    â””â”€ apply_format_rules â†’ apply_format_rules()
            â†“
        Processorå‡¦ç†
            â†“
        ParseResult (å‡¦ç†å¾Œ)
            â†“
    rows = å‡¦ç†çµæœ.rows
    â†“
editModalState.workingRows = rows
    â†“
renderEditTable()
    â†“
UIæ›´æ–°

â€» Edit ãƒ¢ãƒ¼ãƒ€ãƒ«ã§ã¯ ParseResult ã®ã‚¯ãƒ­ãƒ¼ãƒ³ã«å¯¾ã—ã¦å‰å‡¦ç†ã‚’é©ç”¨ã—ã€ä¿å­˜ã¾ã§ã¯ `bom.parseResult` ã‚’ç›´æ¥æ›¸ãæ›ãˆãªã„ã€‚
```

### 4. CADãƒãƒƒãƒˆãƒªã‚¹ãƒˆå‡ºåŠ›ãƒ•ãƒ­ãƒ¼

```
User Action (ã€ŒECO/CCF/MSFå‡ºåŠ›ã€ã‚¯ãƒªãƒƒã‚¯)
    â†“
exportToECO/CCF/MSF() [TypeScript]
    â†“
groupByPartNo(bomData) â†’ Map<PartNo, Refs[]>
    â†“
formatToECO/CCF/MSF(grouped)
    â†“
invoke('save_session_to_file', { path, content })
    â†“
save_session_to_file() [Rust]
    â†“
fs::write(path, content)
    â†“
ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜å®Œäº†
```

## ğŸ”‘ ä¸»è¦ãªè¨­è¨ˆæ±ºå®š

### 1. ãªãœVanilla TypeScriptï¼Ÿ
- **ç†ç”±**: ã‚·ãƒ³ãƒ—ãƒ«ã•ã¨å­¦ç¿’ã‚³ã‚¹ãƒˆã®ä½ã•
- **ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•**: å¤§è¦æ¨¡åŒ–ã™ã‚‹ã¨ä¿å®ˆæ€§ãŒä½ä¸‹ï¼ˆç¾åœ¨ã®èª²é¡Œï¼‰
- **ä»Šå¾Œã®æ–¹é‡**: ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆ†å‰²ã§ç·©å’Œ

### 2. ãªãœRustï¼Ÿ
- **ç†ç”±**:
  - TauriãŒã‚µãƒãƒ¼ãƒˆ
  - é«˜é€Ÿãªãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†
  - å‹å®‰å…¨æ€§
  - ãƒ¡ãƒ¢ãƒªå®‰å…¨æ€§
- **åˆ©ç‚¹**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã€ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¯¾å¿œ

### 3. ãªãœlocalStorageï¼Ÿ
- **ç†ç”±**:
  - ã‚·ãƒ³ãƒ—ãƒ«ãªå®Ÿè£…
  - ã‚µãƒ¼ãƒãƒ¼ä¸è¦
  - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã§å®Œçµ
- **åˆ¶ç´„**:
  - ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºåˆ¶é™ï¼ˆé€šå¸¸5MBï¼‰
  - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å¤šãä¿å­˜ã™ã‚‹ã¨å®¹é‡ä¸è¶³ã®å¯èƒ½æ€§

### 4. IPCé€šä¿¡ã®è¨­è¨ˆ
- **åŒæœŸ vs éåŒæœŸ**: å…¨ã¦éåŒæœŸï¼ˆ`invoke`ï¼‰
- **ãƒ‡ãƒ¼ã‚¿å½¢å¼**: JSON
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: Resultå‹ã‚’JSONã«å¤‰æ›ã—ã¦è¿”å´

## ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è€ƒæ…®äº‹é …

### ãƒœãƒˆãƒ«ãƒãƒƒã‚¯

1. **å¤§è¦æ¨¡BOMã®è§£æ** (10,000è¡Œä»¥ä¸Š):
   - ãƒ•ã‚¡ã‚¤ãƒ«I/O
   - ãƒ¡ãƒ¢ãƒªæ¶ˆè²»
   - å·®åˆ†è¨ˆç®—ã®è¤‡é›‘åº¦: O(nÂ²)

2. **UIæç”»**:
   - å¤§é‡ã®DOMæ“ä½œ
   - ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°

### æœ€é©åŒ–æˆ¦ç•¥

- **Rustå´**:
  - ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã®æ´»ç”¨
  - ä¸è¦ãªã‚¯ãƒ­ãƒ¼ãƒ³ã®å‰Šæ¸›
  - ä¸¦åˆ—å‡¦ç†ã®æ¤œè¨ï¼ˆrayonï¼‰
- **TypeScriptå´**:
  - ä»®æƒ³ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã®æ¤œè¨
  - DOMæ“ä½œã®æœ€å°åŒ–
  - ãƒ‡ãƒã‚¦ãƒ³ã‚¹/ã‚¹ãƒ­ãƒƒãƒˆãƒ«ã®é©ç”¨

## ğŸš§ æŠ€è¡“çš„è² å‚µ

### ç¾åœ¨ã®å•é¡Œç‚¹

1. **ãƒ¢ãƒãƒªã‚·ãƒƒã‚¯ãª main.ts** (3,543è¡Œ)
   - æ©Ÿèƒ½ãŒå…¨ã¦1ãƒ•ã‚¡ã‚¤ãƒ«ã«é›†ç´„
   - ä¿å®ˆæ€§ãƒ»å¯èª­æ€§ãŒä½ã„

2. **ãƒ†ã‚¹ãƒˆã®æ¬ å¦‚**
   - å˜ä½“ãƒ†ã‚¹ãƒˆãªã—
   - ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãŒå±é™º

3. **å‹å®šç¾©ã®æ•£åœ¨**
   - å†åˆ©ç”¨å›°é›£
   - ä¸€è²«æ€§ã®æ¬ å¦‚

4. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚³ãƒ¡ãƒ³ãƒˆä¸è¶³**
   - JSDoc/rustdocãŒå°‘ãªã„

### æ”¹å–„è¨ˆç”»

1. **main.tsã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆ†å‰²** (å„ªå…ˆåº¦: é«˜)
2. **ãƒ†ã‚¹ãƒˆã®è¿½åŠ ** (å„ªå…ˆåº¦: é«˜)
3. **å‹å®šç¾©ã®åˆ†é›¢** (å„ªå…ˆåº¦: ä¸­)
4. **ã‚³ãƒ¡ãƒ³ãƒˆã®è¿½åŠ ** (å„ªå…ˆåº¦: ä¸­)

## ğŸ“š å‚è€ƒè³‡æ–™

- [Tauri Documentation](https://tauri.app/)
- [Rust Book](https://doc.rust-lang.org/book/)
- [TypeScript Handbook](https://www.typescriptlang.org/docs/)
